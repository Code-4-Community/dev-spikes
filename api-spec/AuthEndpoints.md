# Login and Token Endpoints

Common Headers: 
```json
  Content-Type: application/json
```

Access Token Composition:
``` json
{
    "userId": UUID,
    "adminLevel": INT,
    "accountStatus": INT,
    "expiration": TIMESTAMP, 
}

```
- TIMESTAMP: time in milliseconds in UTC.
- adminLevel: integer describing the user's priviledge level. 
    - 0: Not an admin.
    - 1: Is an admin.
    - 2: LLB Terminal Illness family? // TODO
- accountStatus: integer describing the status of the account.
    - 0: Account not yet confirmed.
    - 1: Account confirmed.
    - 2: Account awaiting admin confirmation.

For any protected route, if the access token included in the request header has expired the backend will return the string below it indicate that a refresh is necessary.
```json
 "Given access token is expired or invalid"
```


**All routes are prepended with `api/v1/` unless otherwise noted!!**

## `POST user/login`

>Used for logging in.

### __Request__

Body:
```json
{
    "username" : EMAIL or USERNAME,
    "password" : STRING,
    "rememberMe": BOOLEAN  
}
```
  An EMAIL is a string representing a user's email.

  A USERNAME is a string representing a user's username.
  
  rememberMe is a feature to be included in future versions.
  
### __Responses__ 
 

#### `201 Created`

> The username/password combination is valid. Includes distinct access and refresh tokens for the given user. 

Body: 
```json
{
  "accessToken"  : JWT,
  "refreshToken" : JWT
}
```
#### `400 Bad Request`
> Malformed request.

#### `401 Unauthorized`
> The username/password combination is invalid.

## `POST user/login/refresh`

> Used for getting a new access token.

### __Request__

Headers:

```json
  X-Refresh-Token : JWT
```

### __Responses__ 

#### `201 Created`
> The refresh token is valid and has not yet expired. Response includes a new unique access_token.

Body: 
```json
{
  "accessToken" : JWT,
}
```

#### `401 Unauthorized`
> The refresh token is invalid.


## `DELETE user/login`

> Used for logging out.

### __Request__

Headers:

```json
  X-Access-Token : JWT
  X-Refresh-Token : JWT
```

### __Responses__ 

#### `204 No Content`
> Logout successful.


## `POST user/signup`

> Used for signing up a new user.

Body

```json
{
  "email" : EMAIL,
  "password" : PASSWORD,
  "firstName" : STRING,
  "lastName" : STRING
}
```

- EMAIL: Is a valid email string.
- PASSWORD: Is a valid password string that is at least 8 characters.

### __Responses__ 

#### `201 Created`
> The username and email are still available, and an account has been successfully created.

Body: 
```json
{
  "accessToken"  : STRING,
  "refreshToken" : STRING
}
```
 
#### `400 Bad Request`
> Malformed request body.

```jsonld=
{
    "error_message": STRING
}
```

#### `409 Conflict`
> There has been a conflict regarding the unique identifiers email and/or username.

## `GET user/verify/:secret_key`

>Used for confirming an account

### __Request__
PATH: `GET user/verify/:secret_key`

- secret_key: is a secret key randomly generated by the backend and sent to the user by email.
  
### __Responses__ 
 
#### `200 OK`

> The user's secret key has been verified. 

#### `401 Unauthorized`
> The secret key is invalid or expired.

## `GET user/create_secret/:user_id`

> Used for creating secret keys for users.

### __Request__
PATH: `GET user/create_secret/:user_id`

### __Responses__

#### `200 OK`
> The a secret key was created and stored for the given user.

#### `401 Unauthorized`
> The given user id could not be found.
